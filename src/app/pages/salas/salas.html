<div class="min-h-screen bg-gray-50 p-6">
  <div class="max-w-7xl mx-auto">
    <!-- Header -->
    <div class="mb-6 flex justify-between items-center">
      <div>
        <h1 class="text-3xl font-bold text-gray-800">Gestão de Salas</h1>
        <p class="text-gray-600 mt-1">Gerencie as salas de laboratório</p>
      </div>
      <div class="flex gap-3">
        <button
          (click)="voltar()"
          class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors shadow-md"
        >
          Voltar
        </button>
        <button
          (click)="abrirFormularioCadastro()"
          class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-md flex items-center gap-2"
        >
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
            <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
          </svg>
          Nova Sala
        </button>
      </div>
    </div>

    <!-- Loading -->
    <div *ngIf="isLoading" class="text-center py-12">
      <div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"></div>
      <p class="mt-4 text-gray-600">Carregando salas...</p>
    </div>

    <!-- Lista de Salas -->
    <div *ngIf="!isLoading && salas.length > 0" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      <div
        *ngFor="let sala of salas"
        class="bg-white rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300 overflow-hidden"
      >
        <!-- Status Badge -->
        <div class="px-6 pt-4 pb-2 bg-gradient-to-r from-blue-500 to-indigo-600">
          <div class="flex justify-between items-center">
            <h3 class="text-xl font-bold text-white truncate">{{ sala.nome }}</h3>
            <span
              [class]="sala.status ? 'bg-green-500' : 'bg-red-500'"
              class="px-3 py-1 rounded-full text-xs font-semibold text-white"
            >
              {{ sala.status ? 'Ativa' : 'Inativa' }}
            </span>
          </div>
        </div>

        <!-- Conteúdo -->
        <div class="p-6">
          <div class="space-y-3 mb-4">
            <div class="flex items-center text-gray-700">
              <svg class="w-5 h-5 mr-2 text-blue-600" fill="currentColor" viewBox="0 0 24 24">
                <path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/>
              </svg>
              <span><strong>Capacidade:</strong> {{ sala.capacidade }} pessoas</span>
            </div>
            <div class="flex items-center text-gray-700">
              <svg class="w-5 h-5 mr-2 text-blue-600" fill="currentColor" viewBox="0 0 24 24">
                <path d="M20,18c1.1,0,2-0.9,2-2V6c0-1.1-0.9-2-2-2H4C2.9,4,2,4.9,2,6v10c0,1.1,0.9,2,2,2H0v2h24v-2H20z M4,6h16v10H4V6z"/>
              </svg>
              <span><strong>Equipamentos:</strong> {{ sala.qtdEquipamentos }}</span>
            </div>
          </div>

          <!-- Ações -->
          <div class="flex gap-2 pt-4 border-t border-gray-200">
            <button
              (click)="abrirFormularioEdicao(sala)"
              class="flex-1 px-3 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 transition-colors text-sm font-semibold"
              title="Editar sala"
            >
              Editar
            </button>
            <button
              (click)="alterarStatus(sala)"
              [class]="sala.status ? 'bg-orange-500 hover:bg-orange-600' : 'bg-green-500 hover:bg-green-600'"
              class="flex-1 px-3 py-2 text-white rounded-lg transition-colors text-sm font-semibold"
              [title]="sala.status ? 'Desativar sala' : 'Ativar sala'"
            >
              {{ sala.status ? 'Desativar' : 'Ativar' }}
            </button>
            <button
              (click)="deletarSala(sala)"
              class="px-3 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors text-sm font-semibold"
              title="Excluir sala"
            >
              Excluir
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="!isLoading && salas.length === 0" class="text-center py-12">
      <svg class="w-24 h-24 mx-auto text-gray-400 mb-4" fill="currentColor" viewBox="0 0 24 24">
        <path d="M19,3H5C3.9,3,3,3.9,3,5v14c0,1.1,0.9,2,2,2h14c1.1,0,2-0.9,2-2V5C21,3.9,20.1,3,19,3z M19,19H5V5h14V19z M7,10h2v7H7V10z M11,7h2v10h-2V7z M15,13h2v4h-2V13z"/>
      </svg>
      <h3 class="text-xl font-semibold text-gray-700 mb-2">Nenhuma sala cadastrada</h3>
      <p class="text-gray-500 mb-4">Cadastre a primeira sala de laboratório clicando no botão acima.</p>
    </div>
  </div>

  <!-- Modal Formulário -->
  <div
    *ngIf="showForm"
    class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 animate-fade-in"
    (click)="fecharFormulario()"
  >
    <div
      class="bg-white rounded-xl shadow-2xl w-full max-w-md p-6 animate-scale-in"
      (click)="$event.stopPropagation()"
    >
      <!-- Header do Modal -->
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold text-gray-800">
          {{ isEditing ? 'Editar Sala' : 'Nova Sala' }}
        </h2>
        <button
          (click)="fecharFormulario()"
          class="text-gray-500 hover:text-gray-700 transition-colors"
        >
          <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
            <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
          </svg>
        </button>
      </div>

      <!-- Formulário -->
      <form (ngSubmit)="onSubmit()" class="space-y-4">
        <div>
          <label for="nome" class="block text-sm font-medium text-gray-700 mb-1">
            Nome da Sala <span class="text-red-500">*</span>
          </label>
          <input
            type="text"
            id="nome"
            [(ngModel)]="nome"
            name="nome"
            required
            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            placeholder="Ex: Laboratório de Informática 1"
          />
        </div>

        <div>
          <label for="capacidade" class="block text-sm font-medium text-gray-700 mb-1">
            Capacidade (pessoas) <span class="text-red-500">*</span>
          </label>
          <input
            type="number"
            id="capacidade"
            [(ngModel)]="capacidade"
            name="capacidade"
            min="0"
            required
            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            placeholder="Ex: 40"
          />
        </div>

        <div>
          <label for="qtdEquipamentos" class="block text-sm font-medium text-gray-700 mb-1">
            Quantidade de Equipamentos
          </label>
          <input
            type="number"
            id="qtdEquipamentos"
            [(ngModel)]="qtdEquipamentos"
            name="qtdEquipamentos"
            min="0"
            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            placeholder="Ex: 20"
          />
        </div>

        <!-- Botões -->
        <div class="flex gap-3 pt-4">
          <button
            type="button"
            (click)="fecharFormulario()"
            class="flex-1 px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-semibold"
          >
            Cancelar
          </button>
          <button
            type="submit"
            [disabled]="!nome || capacidade === null || capacidade < 0 || isSubmitting"
            class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold disabled:bg-gray-400 disabled:cursor-not-allowed"
          >
            {{ isSubmitting ? 'Salvando...' : (isEditing ? 'Atualizar' : 'Cadastrar') }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
